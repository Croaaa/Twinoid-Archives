<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Probabilités et floating point precision</title>
    <link href="../../../../gfx/game/Twinoid.ico" rel="icon" type="image/gif"/>
    <link href="../../../../css/twinoid_layout.css" rel="stylesheet" type="text/css"/>
    <link href="../../../../css/twinoid_bar.css" rel="stylesheet" type="text/css"/>
    <link href="../../../../css/custom.css" rel="stylesheet" type="text/css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('.tid_niceHiddenNotice').click(function() {
                $(this).next('.tid_post').slideDown(500);
                $(this).slideUp(250);
            });
        });
    </script>
</head>
<body>
    <div id="contentBg">
        <div class="tid_forum_init" id="tid_forum">
            <div id="tid_forum_all"></div>
            <table class="tid_forumLayout">
                <tbody>
                    <tr>
                        <td id="tid_forum_right">
                            <div class="tid_containerWrapper">
                                <div class="tid_forumThread">
                                    <div class="tid_mainBar">
                                        <div class="tid_stack tid_bg4">
											<a class="tid_bg4" href="../../../Index.html" tid_href="left:">
												<img src="../../../../gfx/design/flag_FR.svg" style="width: 20px; height: 15px; vertical-align: middle;">
												Accueil
											</a>
                                            <a class="tid_bg4" href="../../Index.html" tid_href="left:">Twinoid</a>
                                            <a class="tid_bg4" href="../Index.html" tid_href="left:">Développement</a>
                                            <span class="tid_title">Probabilités et floating point precision</span>
                                        </div>
                                        
                                    </div>
                                    <div class="tid_clear tid_threadStart"></div>
                                    <div class="tid_post tid_ tid_read" id="tid_forumPost_0">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Bonjour tout le monde <img src="../../../../gfx/square/smile.png" alt=":)" class="tid_ico"></p><p>Je cherche en ce moment à réaliser une petite page web permettant de calculer les chances de morts sur plusieurs veilleurs pour Hordes (je suis débutant en programmation et un jeu me parait parfait pour me donner des "exercices", si l'on veut).</p><p>Ça avance plutôt bien mais je rencontre un souci mineur : <br>Lorsque je demande à mon script de calculer quelquechose comme</p><pre>0.1 * 0.2
</pre><p>J'obtiens</p><pre>0.020000000000000004
</pre><p>Si j'ai bien compris, cela vient du fait que les nombres décimaux sont stockés par l'ordinateur en tant que fraction binaire, et que donc certains nombres en base décimal sont tout simplement irreprésentables de manières finies en binaire.</p><p>Quelqu'un connaît-il un moyen de pallier à ce comportement ? J'ai d'abord pensé à arrondir, mais en cas d'opération successives, la précision est vite perdue :/</p><p>En vous remerciant.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_1">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Tu souhaites obtenir des résultats exact avec des décimaux ? Si c'est ça ce n'est pas possible. Par contre si tu calculs des probabilités tu pourrais utiliser des entiers (20 au lieu de 0.2 par exemple) puis diviser seulement le résultat final.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_2">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Le souci, c'est que je multiplie à chaque étape.<br>En gros je construit un arbre de probabilité binaire, d'une profondeur égale au nombre de test.<br>Donc si je multiplie par 100 (pour ma proba de 0.2 se transforme en 20), le facteur se rajoute au calcul à chaque test, si bien que lorsque je fais 15 tests (par exemple), je devrais ensuite diviser par 100^15 :/<br>Et il me semble que ça dépasse la valeur maximale d'un entier... <img src="../../../../gfx/square/sad.png" alt=":(" class="tid_ico"></p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_3">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_c_e_bb98eb58_8542_100x100.png" title="arcanmster" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_8542 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/8542/1" tid_id="8542">arcanmster</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\rwrd_cervelle.png" title=""/> H4ck3R au FJV</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Quel langage ?</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_4">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>En javascript (j'oublié ça, je suis un peu étourdi moi...)<br>Donc 2^53 -1 au maximum si je ne me trompe pas.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_5">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>les valeurs sur les branches de ton arbres sont calculées de quelle manière ?</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_6">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Fail, une seconde.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_7">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>En fait je me demandais si chaque branche pouvais prendre n'importe quelle valeur ou bien si c'était souvent les mêmes comme 0.2, 0.1, etc</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_8">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Bah à chaque test la probabilité est différente (enfin, pas nécessairement, mais peut l'être) :/ Sinon je pourrais utiliser la loi binomiale.</p><p>Ma fonction ressemble à ça.</p><p><a href="http://pastebin.com/HCDk9ZNg" target="_blank">http://pastebin.com/HCDk9ZNg</a></p><p>(Sachant que je déclare result_array dans la fonction qui contient celle-ci);</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_9">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Est-ce que ça te serait possible de travailler avec des fractions au lieu de nombres décimaux (tu remplaces ton décimal par un entier numérateur et un entier dénominateur). Ensuite tu fais le produit de tous les numérateurs, le produit de tous les dénominateurs et tu effectues une seule division avec les deux résultats.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_10">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Bah ça revient au même que ce qui est dit plus haut, le dénominateur sera toujours 100.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_11">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Ha autant pour moi, je pensais que tes valeurs était le résultat d'une division.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_12">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Bah c'est des probas^^.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_13">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Donc les valeurs de proba_array sont calculées comment ?</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_14">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Je vois pas où tu veux en venir. Quelque soit la façon dont elle sont calculées, ça revient au même^^. Que j'ai directement 0.97 ou que j'ai 97 que je divise par 100 c'est la même chose.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_15">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Si tu avais eu 2/5 au lieu de 0.4, et que toutes les valeurs était de ce genre ca aurait pu permettre de n'utiliser que des entiers avant de faire les divisions.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_16">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Ha ! Je vois ce que tu veux dire. Mais toutes les valeurs sont rapportables à des fractions sur 100, donc ^^.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_17">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Farijo" style="background-color: rgb(82,118,204); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 22 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_19662 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/19662/1" tid_id="19662">Farijo</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_jtamer.gif" title=""/> Terroriste dans into the sky</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Ok, s'il y a pas moyen de toucher aux valeurs de proba_array je vois pas trop ^^.</p><p>Si le problème est la précision je pense qu'il faut que tu essayes de n'utiliser que des int pour supprimer complètement l'imprécision ou alors d'utiliser des valeurs plus grandes pour réduire l'imprécision.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_18">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="ayalti" style="background-color: rgb(204,171,82); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 23 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_36044 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/36044/1" tid_id="36044">ayalti</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>C'est un faux problème hein.</p><p>Si ton nombre avait été pi, tu ne te serais pas inquiété du fait qu'il vaut 3,141592653589793236 au lieu de 3,141592653589793238<br>Tu aurais pensé que ce n'est qu'une erreur numérique tout à fait mineure et acceptable. <br>Ca n'est pas pire quand il s'agit d'une valeur dont tu connais la valeur exacte.<br>0,2, c'est, à une erreur numérique parfaitement acceptable près, 0,20000000000000002</p><p>La solution est donc de ne rien faire. C'est très bien comme ça. Et si le problème est que c'est pas joli à afficher, fais un arrondi seulement au moment où tu affiches des choses sur ta page web (mais sans toucher aux variables utilisées dans le calcul. Genre tu affiches Math.round(x*100)/100, mais sans modifier x donc).<br><span class="tid_sideNote">C'est d'ailleurs ce que font beaucoup de fonctions "print" de divers langages de programmation. C'est à cause de ça que beaucoup de gens croient, à tort, que c'est un problème spécifique de javascript. Alors qu'en réalité, dans tous les langages du monde, avec de la virgule flottante, on a ce genre de petite erreur numérique. Mais la plupart des fonctions "print" arrondissent pour afficher des nombres plus jolis, en apparrence, tant qu'on n'accumule pas trop de calcul. Par exemple, pour schématiser, si on a une représentation interne permettant 20 chiffres significatifs, une fonction "print" qui arrondi aux 15 chiffres significatifs près cachera cette erreur, tant qu'on n'a pas accumulé une erreur numérique qui s'étend sur 5 chiffres. Or quand on a accumulé une telle erreur numérique, c'est que les calculs sont tellement compliqués que plus personne ne s'attend à voir des valeurs exactes.</span></p><br><br><p>Si ce que tu crains est que l'erreur numérique soit trop forte à force de s'accumuler, j'en doute fortement. Des calculs de probabilité de survie ne peuvent pas être tels que l'erreur numérique s'accumule. Tu construits un arbre. C'est la profondeur de l'arbre qui fera que l'erreur numérique s'accumule, si j'ai bien suivi (puisque chaque calcul de proba est un parcours de la racine vers une feuille). Si la profondeur de ton arbre était telle que tu commences à avoir un problème de précision du à l'accumulation d'erreur numérique, alors il te faudrait des teraoctets de RAM pour stocker ton arbre<br>(il faudrait un arbre d'une profondeur de l'ordre de 50, ce qui signifie stocker de l'ordre de 2^50 valeurs...)<br>Donc, aucun problème d'erreur numérique qui s'accumule (tant que tu ne fais pas ce que tu avais envisager, ie arrondir à chaque étape, et que tu n'arrondis que lors de l'affichage, pour des raisons purement esthétiques).</p><p>Mais si vraiment tu crains une accumulation d'erreur numérique à coup de multiplications, l'astuce consiste à transformer tes multiplications en addition, en stockant des logarithmes à la place des probas (et en en calculant l'exponentielle au moment de l'affichage). Là, tu es carrément peinard pour un arbre d'une profondeur de l'ordre de 2^50...</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_19">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="ayalti" style="background-color: rgb(204,171,82); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 23 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_36044 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/36044/1" tid_id="36044">ayalti</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Sinon, si tu veux vraiment des valeurs exactes, je dois contester la solution proposée jusque là : stocker dans des entiers n'amène à rien, et c'est particulièrement flagrant dans le cas de JavaScript : JavaScript n'a pas d'entiers. C'est un type inexistant en JS.</p><p>Quand on dit "il y a des entiers qui peuvent valoir jusqu'à 2^53" c'est une erreur ou au mieux un abus de langage : JS n'a que des flottants. Mais comme il y a 53 bits de ces flottants consacrés à la mantisse, forcément tous les nombres entiers compris entre 0 et 2^53-1 s'écrivent en virgule flottante avec une mantisse correspondant à l'entier, et un exposant 0</p><p>Travailler avec des "entiers", ce n'est donc que travailler avec des nombres qui se représentent sans approximation avec mantisse/exposant.<br>Multiplier par 100 ne résoudra donc rien (en fait, dans le cas de 100, ça empire même la situation. Dans le cas de 128, ça ne fait qu'ajouter 7 à l'exposant, et manipuler toujours les mêmes 53 bits de précision).</p><p>Dit autrement : dans les autres langages, avec entiers ou pas, tu as 53 bits de précision. Si tu les dépasses, avec des flottants, tu commences à devoir arrondir ; avec des entiers, tu commences à ne plus pouvoir bosser. Donc, dans les autres langages, tant que tu manipules moins de 53 bits, de toutes façons, tu ne perds pas de précision en travaillant avec des flottants. Si tu dépasses 53 bits (parce que tu as multiplié une cinquantaine de nombres successivement), alors, tu as le choix entre planter (avec des entiers) ou être approximatif (avec des flottants).</p><p>Mais en JS c'est encore pire : il n'y a aucun choix; Avec les entiers ce sera pareil : quand tu vas dépasser 2^53, ils ne seront plus précis qu'à 2 près, puis 4 près, etc. Sur le web on trouve des gens qui (à tort) disent qu'après 2^53 l'entier est converti en flottant. C'est faux. C'est juste qu'il a toujours été un flottant depuis le début, mais que c'est qu'à partir de 2^53 que ça se voit, parce que ce n'est que là qu'il n'est plus capable de représenter chaque valeur.</p><p>Donc, en JS, manipuler des entiers pour se donner l'illusion de travailler avec exactitude, c'est un trompe l'oeil ; dans les faits tu travailles avec des flottants, et tu disposes de très exactement la même précision que si tu n'avais rien traffiqué du tout.</p><br><br><p>SAUF, et c'est là une piste de solution si tu veux travailler avec des valeurs exactes, si, tu travailles avec des fractions (numérateur/dénominateur) et que, à chaque étape intermédiaire, tu simplifie la fraction (en divisant numérateur et dénominateur par leur PGCD).<br>Mais ça implique de créer ton propre type de nombres (une paire numérateur / dénominateur), et d'écrire tes propres opérateurs arithmétiques dessus (une fonction plus, moins, mult, divise). <br>Et ça implique qu'il y ait toujours une simplification possible pour que jamais ni numérateur, ni dénominateur dépasse 2^53. <br>Ou alors, tant qu'on y est à créer ses propres nombres, si tu prévois carrément de coder des entiers sans limite)</p><p>Franchement, je n'en vois pas l'intérêt. Mais si tu veux des valeurs plus exactes que les flottants, il faut passer par là.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_20">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 23 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Je pense que je vais opter pour la première solution^^ <br>Ce qui me faisait douter, c'est que je n'étais pas certain de l'ampleur que pouvait prendre l'accumulation d'erreur minimes (je suis loin d'être une bête en mats^^)<br>Et puis je pense aussi que j'ai trop tendance à vouloir faire quelquechose de "propre" (si l'on peut dire) au lieu de me contenter de trouver la solution à mon problème^.</p><p>En l'occurence, la profondeur de l'arbre ne dépassera jamais 40, dans le pire des cas (et ce sera d'ailleurs très souvent moins).<br>(Après je n'ai pas particulièrement à me soucier de problème de stockage parce que je ne stocke pas l'arbre en fait, je me contente une fois arriver au bout d'une branche d'ajouter le résultat dans un tableau dont l'index est le nombre de succès <img src="../../../../gfx/square/wink.png" alt=";)" class="tid_ico"> Le pire qui puisse m'arriver est d'avoir quelques quarante fonctions dans la pile d'exécution, ce qui n'est pas énorme je crois <img src="../../../../gfx/square/smile.png" alt=":)" class="tid_ico">.</p><p>Merci pour tes remarques en tout cas, je m'y remets.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_21">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="ayalti" style="background-color: rgb(204,171,82); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 23 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_36044 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/36044/1" tid_id="36044">ayalti</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p><cite>Le pire qui puisse m'arriver est d'avoir quelques quarante fonctions dans la pile d'exécution, ce qui n'est pas énorme je crois</cite>Ah. C'est pas vraiment un arbre alors. Je veux dire, ce n'est un arbre que sur le papier où tu as réfléchi à la question, mais pas dans le code.</p><br><p>Si tu veux te faire une idée de l'erreur, teste ceci en python :</p><pre>x=0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2
y=1/x
z=5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5*5
</pre><p>L'un est un calcul en virgule flottante qui accumule 40 erreurs numériques (de façon multiplicative ; c'est ce qu'il y a de pire ^^. Et en plus 0.2 est un nombre qui se code particulièrement mal en flottant. Contrairement à 0.25 par exemple qui se code de façon exacte). La représentation des flottants de python est la même que celle de JS (64 bits, 53 bits de mantisse, le reste exposant et signe)</p><p>L'autre est un calcul avec des entiers "longs" exacts. <br>Comme y est l'inverse de x (si x est une probabilité, y est le nombre tel que x veut dire "1 chance sur y"<strong></strong>), il devrait donc être égal à z.</p><p>Résultat :</p><pre>y=9.094947017729263e+27
x=9094947017729282379150390625</pre><p>Comme tu peux le constater, les 16 chiffres significatifs affichés pour y (ce qui, admettons le, est stupidement trop) sont bons.<br>Si tu t'amuses à afficher</p><pre>y-9.09494701e27</pre><p>on voit que sur la suite c'est déjà moins bon. Mais vu ce que tu veux faire, 16 chiffres significatifs, c'est un luxe parfaitement inutile déjà<br>(Tout ce qu'on a besoin de savoir, c'est qu'on a une chance sur 9 milliards de milliards de milliards de survivre dans le cas présent^^ Personne ne va demander si c'est 9 ou plutôt 9,1. Même "aucune chance en pratique" ou "une chance sur des tas de milliards de milliards" est largement suffisant comme info)</p><p>Autre test signicatif :</p><pre>9094947017729282379150390625*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2*0.2</pre><p>Résultat = 1.0000000000000022</p><p>Franchement, c'est vraiment très bien comme précision. C'est pas pour rien que jusqu'à il y a peu personne n'utilisait des flottants 64 bits sans avoir vraiment vérifié qu'il y en avait vraiment vraiment besoin, parce que des flottants 32 bits (donc carrément moins précis) étaient largement suffisants, même pour des calculs de rentrée dans l'athmosphère de la NASA.</p><p>40 multiplications c'est rien.</p><p>Ce qui justifie des flottants 64 bits, c'est plus les gens qui font des schéma d'intégration où, au bout de 1 milliard de pas de temps, on espère encore avoir une erreur numérique acceptable. Ou bien ceux qui font des éléments finis, avec une matrice 100.000 x 100.000 à inverser.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_22">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 23 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p><span class="tid_preCite"><span class="tid_user tid_user_36044 tid_userBg tid_userUnknown tid_parsed" tid_bg="1" tid_id="36044">ayalti</span></span><cite>Ah. C'est pas vraiment un arbre alors. Je veux dire, ce n'est un arbre que sur le papier où tu as réfléchi à la question, mais pas dans le code.<br><br><br>Si tu veux te faire une idée de l'erreur, teste ceci en python :</cite></p><p>Oui, je "simule" en quelque sorte la construction sur papier d'un arbre de probabilités, mais ce n'est pas à proprement parler un arbre un effet (heureusement, ça ferait beaucoup de trucs à stocker sinon <img src="../../../../gfx/forum/smiley/h_surprise.gif" alt=":O" class="tid_ico">).</p><p>Donc en gros, tant que je n'ai pas un nombre d'opérations vraiment très grand (exponentielle à l'entrée ?), la marge d'erreur n'est pas signifiante. <br>Bah tant mieux^.</p><p>P.S. : Pour ce genre de test, je peux utiliser également la console dans les outils de développement de chrome/firefox, les nombres y sont codés de la même façon ?</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_23">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="ayalti" style="background-color: rgb(204,171,82); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 26 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_36044 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/36044/1" tid_id="36044">ayalti</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Tiens, au fait, en me relisant, je viens de m'apercevoir que j'ai laissé une coquille importante (mais qui va dans le sens d'accorder encore trop d'importance à l'erreur numérique, alors que mon discours était déjà qu'elle n'en avait aucune).</p><p>J'ai dis "tant que l'arbre n'a pas comme profondeur 50" on est peinard.<br>Mais c'est "2^50, bien sûr".</p><p>L'erreur numérique due à la multiplication est pire que celle de l'addition, mais pas à ce point là tout de même.</p><p>Quand on multiplie deux nombres, A et B, avec une erreur numérique a et b,<br>ça donne (A+a)*(B+b) = AB + aB + bA + ab<br>Dans les faits, la représentation en virgule flottante fait que l'erreur numérique est proportionnelle au nombre représenté (puisqu'en réalité l'ordre de grandeur du nombre est représenté de façon exacte dans l'exposant. C'est les "chiffres après la virgule de la mantisse" qui ne sont pas représentés. Donc on fait une erreur qui est toujours de l'ordre de 2^-taillemantisse fois la valeur du nombre.<br>Dit autrement, a est de l'ordre de A*2^-53 et b de l'ordre de B*2^-53</p><p>Donc (A+a)*(B+b) = AB + A*2^-53*B + B*2^-53*A + A*2^-53**B*2^-53<br>ou = A*B*(1+2^-53)² = AB*(1 + 2*2^-53 + 2^-53²) = AB*(1+2*2^-53+2^-106)<br><br>Le 2^-106 est négigeable devant le reste. Donc, on voit que, en pourcentage du résultat final (de AB), l'erreur est de l'ordre de 2*2^-53. <br><br>Si je généralise ça, si je multiplie N nombres dont le produit vaut R, je vais avoir comme résultat erroné :<br>R*(1+2^-53)^N = <br>R*(1 + C_N^1*2^-53 + C_N^2*(2^-53)² + ... + (2^-53)^N)<br>Soit une erreur, en pourcentage par rapport à R, de : C_N^1*2^-53 + C_N^2*(2^-53)² + ... + (2^-53)^N<br><br>Tous les termes sont négligeables devant le premier.<br><br>D'où l'ordre de l'erreur d'une multiplication de N termes : C_N^1 * 2^-53<br>Comme C_N^1 vaut N (le C du triangle de pascal), <br>on voit que multiplier N termes induit une erreur numérique de l'ordre de N*2^-53 en pourcentage.<br><br>Il faudrait donc multiplier 2^43 nombres (que j'avais arrondi à 2^40 à la louche) avant que l'erreur numérique atteigne un millième du résultat.<br><br>Or comme tu ne comptes pas, je suppose afficher plus de 3 chiffres significatifs (les 2 chiffres du %, plus 1 chiffre après la virgule, par exemple), tu es peinard.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_24">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_f_4_bd737cc4_1288552_100x100.jpg" title="VannTen" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 26 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_1288552 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/1288552/1" tid_id="1288552">VannTen</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\r_wondrs.gif" title=""/> Grand architecte</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Je te suis à peu près ton explication jusqu'à "C du triangle de pascal" ; le triangle de Pascal, je vois à peu près, mais là je suis un peu perdu, si tu pouvais (encore^^) éclairer ma lanterne... <img src="../../../../gfx/square/smile.png" alt=":)" class="tid_ico"></p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_25">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_3_6_5f5566f2_148_100x100.png" title="Bugzilla" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 26 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_148 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/148/1" tid_id="148">Bugzilla</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\Dark.png" title=""/> DivinitÃ© diabolique</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Ce n'est pas facile d’écrire sur ce forum une formule incluant un <a target="_blank" href="https://fr.wikipedia.org/wiki/Coefficient_binomial">Coefficient Binomial</a> car on ne peut pas utiliser la notation avec les grandes parenthèses sur deux lignes, ni le grand C avec paramètres en indice et exposant. Je suppose que c'est pour cela qu'ayalti a utilisé C_x^y. Voir en particulier la section "<a target="_blank" href="https://fr.wikipedia.org/wiki/Coefficient_binomial#D.C3.A9veloppement_du_bin.C3.B4me_de_Newton">Développement du binôme de Newton</a>" qui correspond à ce que fait ayalti ci-dessus.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_26">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="Watilin" style="background-color: rgb(82,204,157); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 26 octobre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_378517 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/378517/1" tid_id="378517">Watilin</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>Coucou les gens,</p><p>j'ai parcouru rapidement la conversation et j'ai vu deux-trois choses qui ont retenu mon attention. Je viens étaler ma science dans l'espoir d'aider, et de ne pas trop passer pour le type qui étale sa science <img src="../../../../gfx/square/confused.png" alt=":sq_confused:" class="tid_ico"></p><p><img src="../../../../gfx/square/arrow.png" alt=":arrow:" class="tid_ico"> <strong>La limite maximale des nombres en virgule flottante est 2^53</strong><br>C'est vrai et faux en même temps. En double précision, on peut aller jusqu'à un peu plus de <strong>10^308</strong> (en réalité 2^1024 - 1), ce qui laisse une sacrée marge de manœuvre. Pour vérifier, c'est assez simple : ouvrez votre console JavaScript en appuyant sur F12, et tapez <em>1e309</em>. La console vous répondra <em>Infinity</em>. Qu'est-ce que ça veut dire ? Ça veut dire que le nombre a dépassé la capacité de représentation en double précision et qu'il est juste considéré comme « trop grand ».<br>Si vous tapez <em>1e308</em>, la console vous répond <em>1e308</em>, ce qui montre que le nombre est utilisable.</p><p><strong>Cela dit,</strong> la console fournit aussi une constante <strong>Number.MAX_SAFE_INTEGER</strong> qui se trouve être égale à 2^53 - 1 (environ 10^15). Les nombres supérieurs à ce seuil ne sont plus considérés comme des entiers, et le risque d'erreur apparaît.<br>Avec des multiplications par 100, on a donc le droit de faire <strong>7 opérations</strong> avant de dépasser le seuil « safe ».<br>Mais comme <span class="tid_user tid_user_36044 tid_userBg tid_userUnknown tid_parsed" tid_bg="1" tid_id="36044">ayalti</span> l'a superbement démontré, les erreurs propagées sont largement négligeables.</p><br><p><span class="tid_wspoil">.</span><br><img src="../../../../gfx/square/arrow.png" alt=":arrow:" class="tid_ico"> <strong>Il n'y a pas de type entier en JavaScript</strong><br>C'est vrai. En JavaScript, les nombres sont tous représentés en double précision, ce qui implique qu'ils sont tous des nombres à virgule.</p><p><strong>Mais,</strong> la représentation en virgule flottante a dès le départ été prévue pour donner des résultats exacts avec les nombres entiers. Donc, on élimine bel et bien les risques d'erreur en ne calculant qu'avec des entiers, dans la limite du fameux 2^53.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_27">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_6_f_775674be_4030.jpg" title="Musaran" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 25 novembre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_4030 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/4030/1" tid_id="4030">Musaran</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\book.png" title=""/> Chineur de la Connaissance</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>L'imprécision est peut-être en fait exacte pour ce cas.</p><br><p>Car si le jeu applique une proba de 20%, il est des plus probables que ce soit par simple multiplication de "0,2 flottant", donc avec la légère erreur de représentation binaire.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_28">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\img_defaultAvatar.png" title="ayalti" style="background-color: rgb(204,171,82); width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 25 novembre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_36044 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/36044/1" tid_id="36044">ayalti</a>
        </div>
        <div class="tid_title">
            
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>J'en doute. Quand tu veux faire un truc qui marche une fois sur 5, tu ne manipules pas de virgule flottante en le faisant, si ? Et encore moins par multiplication.</p><p>Moi, en tous cas, j'écrirais if(random()%5==0) ou if(random(5)==0), suivant l'API.<br>Random étant le random banal du langage.<br>Ou s'il y en a pas, un truc habituel (seed=564611 ; random(){ seed=(5456407*seed+187463)%1649769; return seed;}) (en remplaçant mes nombres pifométriques par des choisis pour garantir l'absence de cycles trop courts. Mais sauf pas de bol, mes nombres sont probablement déjà très très suffisants pour un jeu)</p><p>Bref, aucune virgule flottante dans l'affaire. La plupart du temps quand une API propose un random en flottant, entre 0 et 1, c'est le contraire : c'est le random en virgule flottante qui est implémenté par un random entier (return seed/1649769.0; en l'occurrence)</p><br><p>En revanche, il est vrai qu'il faut un sacré nombre de tirages avant que la loi des grands nombres permette de discriminer entre une méthode qui a 20% de chances de succès et une méthode qui en a 20.00000000001%.</p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div><div class="tid_post tid_ tid_read" id="tid_forumPost_29">
    <div class="tid_header tid_bg1">
        <div class="tid_floatBox">
            <table class="tid_valign" style="width : 80px">
                <tbody>
                    <tr>
                        <td>
                            <div class="tid_twinoidAvatar" style="width:80px; max-height:80px; height:80px;">
                                <img src="..\..\..\..\gfx\avatars\twinoid_6_f_775674be_4030.jpg" title="Musaran" style="background-color: ; width: 80px;">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tid_date">
            Le 29 novembre 2015
        </div>
        <div class="tid_name">
            <a class="tid_user tid_user_4030 tid_userNoBg tid_userFriend tid_parsed" href="//twinoid.com/user/go/4030/1" tid_id="4030">Musaran</a>
        </div>
        <div class="tid_title">
            <span class="tid_userTitle"><img alt="[?]" src="..\..\..\..\gfx\icons\book.png" title=""/> Chineur de la Connaissance</span>
        </div>
        <div class="tid_clearRight"></div>
    </div>
    <div class="tid_body tid_bg2">
        <div class="tid_arrow"></div>
        <div class="tid_originContent">
            <div class="tid_editorContent tid_parsed">
                <p>MT fait du développement rapide.</p><p>Ils ont pas le temps pour ce genre de détails.</p><br><p><span class="tid_sideNote">Et puis <em>if(random()%5==0)</em> n'est pas non plus précis en binaire, donc bon...</span></p>
            </div>
        </div>
        <div class="tid_clear"></div>
    </div>
</div>
                                    <div id="tid_forumReplyForm" style="display: none"></div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>